/* jQuery Vortex 1.0.3 | by Luca Fagioli - Montezuma Interactive | http://www.apache.org/licenses/LICENSE-2.0
 */
(function(b){var a=function(e,g){var q;var n=0;var p=false;var B=b(e);var m=[];var c=[];var f=this;var o=-1;var k=[];var z=false;var d=[];var h=0;var j=[];var v=[];var y=b.extend({speed:50,clockwise:true,manualAdvance:false,beforeAnimation:null,afterAnimation:null,easing:"end",deepFactor:0.5,initialPosition:90},g||{});var s=B.height()/2;var u=B.width()/2;q=B.children().css("position","absolute");var x=q.length*12;var r=1;var w=(x/2)/Math.PI;for(var t=0;t<x;t++){v[t]=(Math.PI*2)*t/x}var A=0;switch(y.initialPosition){case 90:A=Math.PI*1.5;break;case 0:A=0;break;case 180:A=Math.PI;break;case 270:A=Math.PI*0.5;break}q.each(function(G){d[G]={width:b(this).width(),height:b(this).height()};var I=b(this).height()/2;var J=b(this).width()/2;var D=[];for(var E=0;E<x;E+=1){D.push({top:((1+Math.sin(A+(E/w)))*s)-I,left:u*(1+Math.cos(A+(E/w)))-J})}var H=G*Math.round(x/q.length);c[G]=H;var K=(Math.sin(A+v[H])*y.deepFactor);var L=(1+K);var F=d[G].width*L;var C=d[G].height*L;b(this).css({width:F,height:C,top:D[H].top-((C-(d[G].height))/2),left:D[H].left-((F-(d[G].width))/2),"z-index":200+Math.round(100*(Math.sin(A+v[H])))});k[G]=H;m.push(D)});this.stop=function(){clearInterval(n);q.stop();l(false)};this.setClockwise=function(i){y.clockwise=i;if(p){this.start()}};var l=function(i){p=i;if(p===true){B.addClass("vortex-animating");if(y.beforeAnimation){if(y.beforeAnimation.call()===false){return false}}}else{B.removeClass("vortex-animating");if(y.afterAnimation){y.afterAnimation.call(null,b(this))}}};this.isAnimating=function(){return p};this.reset=function(){if(c[0]==k[0]){return}z=true;this.start()};this.start=function(D){this.stop();h=0;l(true);var i;if(y.clockwise===true){i=+r}else{i=-r}var C=function(E,G){var J=m[G];var I=(c[G]+i);if(I<0){I=x-Math.abs(i)}if(I>x-1){I=0}var H=(1+Math.sin(A+v[I])*y.deepFactor);var K=d[G].width*H;var F=d[G].height*H;E.animate({left:J[I].left-((K-(d[G].width))/2),top:J[I].top-((F-(d[G].height))/2),width:K,height:F,"z-index":200+Math.round(100*(Math.sin(A+v[I])))},{duration:y.speed+h,easing:"linear",queue:false,complete:function(){c[G]=I;if(G==q.length-1){o--;if(o==2){h=y.speed*2}}if(f.isAnimating()){if(z==false||k[G]!=I){if(o==0){f.stop();o=-1;return}C(E,G)}else{if(G==q.length-1){f.stop();z=false}}}}})};q.each(function(E){C(b(this),E)})};this.setSpeed=function(i){y.speed=i;if(p){this.start()}};if(!y.manualAdvance){this.start()}this.step=function(i){o=(i*x/q.length);this.start();return}};b.fn.vortex=function(c){return this.each(function(){var e=b(this);if(e.data("vortex")){return}var d=new a(this,c);e.data("vortex",d)})}})(jQuery);
